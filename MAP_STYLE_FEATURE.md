# åœ°å›¾æ ·å¼é€‰æ‹©åŠŸèƒ½å®Œæ•´æŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

æœ¬åŠŸèƒ½ä¸º Flutter Mapbox Navigation æ’ä»¶æä¾›äº†å®Œæ•´çš„åœ°å›¾æ ·å¼ç®¡ç†ç³»ç»Ÿã€‚é€šè¿‡**æ’ä»¶å†…ç½®çš„åŸç”Ÿæ ·å¼é€‰æ‹©å™¨**ï¼Œç”¨æˆ·å¯ä»¥ï¼š

1. âœ… **ä¸€é”®è®¾ç½®åœ°å›¾æ ·å¼** - æ— éœ€ç¼–å†™ä»£ç 
2. âœ… **è‡ªåŠ¨æŒä¹…åŒ–å­˜å‚¨** - è®¾ç½®ä¸€æ¬¡ï¼Œå…¨å±€ç”Ÿæ•ˆ
3. âœ… **æ™ºèƒ½ Light Preset** - æ ¹æ®æ—¶é—´è‡ªåŠ¨é€‰æ‹©å…‰ç…§æ•ˆæœ
4. âœ… **iOS åŸç”Ÿç•Œé¢** - å®Œå…¨ç¬¦åˆ iOS è®¾è®¡è§„èŒƒ
5. âœ… **åœ°å›¾å®æ—¶é¢„è§ˆ** - é€‰æ‹©æ—¶å³å¯çœ‹åˆ°æ•ˆæœ
6. âœ… **è‡ªåŠ¨å®šä½** - åœ°å›¾æ˜¾ç¤ºç”¨æˆ·å½“å‰ä½ç½®

## ğŸ—ºï¸ æ”¯æŒçš„åœ°å›¾æ ·å¼

### æ”¯æŒ Light Preset çš„æ ·å¼ï¼ˆæ¨èï¼‰âœ¨

è¿™äº›æ ·å¼æ”¯æŒæ ¹æ®æ—¶é—´è®¾ç½®ä¸åŒçš„å…‰ç…§æ•ˆæœï¼š

#### 1. **Standard**ï¼ˆæ ‡å‡†æ ·å¼ï¼‰

- URI: `mapbox://styles/mapbox/standard`
- ç‰¹ç‚¹ï¼šMapbox æœ€æ–°çš„æ ‡å‡†æ ·å¼
- æ”¯æŒï¼šâœ¨ Light Presetï¼ˆdawn/day/dusk/nightï¼‰
- æ¨èç”¨é€”ï¼šé€šç”¨åœºæ™¯

#### 2. **Standard Satellite**ï¼ˆå«æ˜Ÿæ ·å¼ï¼‰

- URI: `mapbox://styles/mapbox/standard-satellite`
- ç‰¹ç‚¹ï¼šå«æ˜Ÿå›¾åƒ + è¡—é“æ ‡ç­¾
- æ”¯æŒï¼šâœ¨ Light Preset
- æ¨èç”¨é€”ï¼šéœ€è¦å«æ˜Ÿå›¾çš„åœºæ™¯

#### 3. **Faded**ï¼ˆè¤ªè‰²ä¸»é¢˜ï¼‰

- URI: `mapbox://styles/mapbox/standard`ï¼ˆä¸»é¢˜å˜ä½“ï¼‰
- ç‰¹ç‚¹ï¼šæŸ”å’Œçš„é…è‰²æ–¹æ¡ˆ
- æ”¯æŒï¼šâœ¨ Light Preset
- æ¨èç”¨é€”ï¼šçªå‡ºå…¶ä»–åœ°å›¾å…ƒç´ æ—¶

#### 4. **Monochrome**ï¼ˆå•è‰²ä¸»é¢˜ï¼‰

- URI: `mapbox://styles/mapbox/standard`ï¼ˆä¸»é¢˜å˜ä½“ï¼‰
- ç‰¹ç‚¹ï¼šé»‘ç™½ç°é…è‰²
- æ”¯æŒï¼šâœ¨ Light Preset
- æ¨èç”¨é€”ï¼šæç®€é£æ ¼æˆ–æ‰“å°åœºæ™¯

### ä¼ ç»Ÿæ ·å¼

è¿™äº›æ ·å¼ä¸æ”¯æŒ Light Presetï¼Œä½†æä¾›äº†ç‰¹å®šçš„è§†è§‰æ•ˆæœï¼š

#### 5. **Light**ï¼ˆæµ…è‰²æ ·å¼ï¼‰

- URI: `mapbox://styles/mapbox/light-v11`
- ç‰¹ç‚¹ï¼šæµ…è‰²èƒŒæ™¯ï¼Œç®€æ´æ˜å¿«
- æ¨èç”¨é€”ï¼šæ•°æ®å¯è§†åŒ–ã€æµ…è‰²ä¸»é¢˜

#### 6. **Dark**ï¼ˆæ·±è‰²æ ·å¼ï¼‰

- URI: `mapbox://styles/mapbox/dark-v11`
- ç‰¹ç‚¹ï¼šæ·±è‰²èƒŒæ™¯ï¼Œé€‚åˆå¤œé—´
- æ¨èç”¨é€”ï¼šå¤œé—´æ¨¡å¼ã€èŠ‚çœç”µé‡

#### 7. **Outdoors**ï¼ˆæˆ·å¤–æ ·å¼ï¼‰

- URI: `mapbox://styles/mapbox/outdoors-v12`
- ç‰¹ç‚¹ï¼šåœ°å½¢ã€ç­‰é«˜çº¿ã€æ­¥é“
- æ¨èç”¨é€”ï¼šå¾’æ­¥ã€éª‘è¡Œç­‰æˆ·å¤–æ´»åŠ¨

## âœ¨ Light Presetï¼ˆå…‰ç…§é¢„è®¾ï¼‰

å¯¹äºæ”¯æŒ Light Preset çš„æ ·å¼ï¼ˆStandardã€Standard Satelliteã€Fadedã€Monochromeï¼‰ï¼Œå¯ä»¥è®¾ç½®ä¸åŒæ—¶æ®µçš„å…‰ç…§æ•ˆæœï¼š

### å¯ç”¨çš„ Light Preset

| Preset | å›¾æ ‡ | æ—¶é—´æ®µ | æ•ˆæœæè¿° |
|--------|------|--------|----------|
| **Dawn** | ğŸŒ… | 5:00-7:00 | é»æ˜ - æ¸…æ™¨çš„æŸ”å’Œå…‰çº¿ |
| **Day** | â˜€ï¸ | 7:00-17:00 | ç™½å¤© - æ˜äº®çš„æ—¥å…‰ï¼ˆé»˜è®¤ï¼‰|
| **Dusk** | ğŸŒ‡ | 17:00-19:00 | é»„æ˜ - å‚æ™šçš„æ¸©æš–å…‰çº¿ |
| **Night** | ğŸŒ™ | 19:00-5:00 | å¤œæ™š - å¤œé—´çš„æ·±è‰²è°ƒ |

### æ™ºèƒ½æ—¶é—´åŒ¹é…

æ ·å¼é€‰æ‹©å™¨ä¼šè‡ªåŠ¨æ ¹æ®å½“å‰æ—¶é—´é€‰æ‹©æœ€åˆé€‚çš„ Light Presetï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥æ‰‹åŠ¨é€‰æ‹©å…¶ä»–æ—¶æ®µæŸ¥çœ‹æ•ˆæœã€‚

### åŠ¨æ€åˆ‡æ¢ï¼ˆæ¼”ç¤ºåŠŸèƒ½ï¼‰

å¯ç”¨"åŠ¨æ€åˆ‡æ¢"åï¼Œåœ°å›¾ä¼šæ¯ 5 ç§’è‡ªåŠ¨å¾ªç¯åˆ‡æ¢ Light Presetï¼Œé€‚åˆæ¼”ç¤ºå’Œæµ‹è¯•ï¼š

```text
dawn â†’ day â†’ dusk â†’ night â†’ dawn ...
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ¨èæ–¹å¼ï¼šä½¿ç”¨æ’ä»¶æ ·å¼é€‰æ‹©å™¨

è¿™æ˜¯**æœ€ç®€å•ã€æœ€æ¨è**çš„æ–¹å¼ï¼š

```dart
import 'package:flutter_mapbox_navigation/flutter_mapbox_navigation.dart';

// 1. æ˜¾ç¤ºæ ·å¼é€‰æ‹©å™¨ï¼ˆä¸€é”®è®¾ç½®ï¼‰
await MapboxStylePicker.show();

// 2. åç»­æ‰€æœ‰å¯¼èˆªè‡ªåŠ¨ä½¿ç”¨è®¾ç½®çš„æ ·å¼
await MapBoxNavigation.instance.startNavigation(
  wayPoints: [origin, destination],
  // å®Œå…¨ä¸éœ€è¦ä¼ é€’æ ·å¼å‚æ•°ï¼
);
```

**å°±è¿™ä¹ˆç®€å•ï¼** ç”¨æˆ·è®¾ç½®ä¸€æ¬¡ï¼Œå…¨å±€ç”Ÿæ•ˆã€‚

### é«˜çº§ç”¨æ³•ï¼šæŸ¥è¯¢å’Œæ¸…é™¤è®¾ç½®

```dart
// è·å–å½“å‰è®¾ç½®
final settings = await MapboxStylePicker.getStoredStyle();
print('å½“å‰æ ·å¼: ${settings['mapStyle']}');
print('Light Preset: ${settings['lightPreset']}');

// æ¸…é™¤è®¾ç½®ï¼ˆæ¢å¤é»˜è®¤ï¼‰
await MapboxStylePicker.clearStoredStyle();
```

### ä¼ ç»Ÿæ–¹å¼ï¼ˆä¸æ¨èï¼‰ï¼šæ‰‹åŠ¨ä¼ å‚

å¦‚æœä½ éœ€è¦å®Œå…¨è‡ªå®šä¹‰ï¼Œå¯ä»¥ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼ï¼š

```dart
final options = MapBoxOptions(
  // è‡ªå®šä¹‰æ ·å¼ URL
  mapStyleUrlDay: 'mapbox://styles/your-style',
  mapStyleUrlNight: 'mapbox://styles/your-night-style',
  zoom: 15,
);

await MapBoxNavigation.instance.startNavigation(
  wayPoints: [origin, destination],
  options: options,
);
```

**æ³¨æ„**ï¼šä¸æ¨èæ‰‹åŠ¨ä¼ å‚ï¼Œå› ä¸ºï¼š
- âŒ éœ€è¦æ‰‹åŠ¨ç®¡ç†æ ·å¼è®¾ç½®
- âŒ æ¯æ¬¡å¯¼èˆªéƒ½è¦ä¼ é€’å‚æ•°
- âŒ æ— æ³•å…¨å±€ç”Ÿæ•ˆ
- âœ… æ¨èä½¿ç”¨æ ·å¼é€‰æ‹©å™¨è‡ªåŠ¨ç®¡ç†

## ğŸ“± æ ·å¼é€‰æ‹©å™¨ç•Œé¢

### iOS åŸç”Ÿç•Œé¢ç‰¹æ€§

æ’ä»¶æä¾›äº†å®Œå…¨ç¬¦åˆ iOS è®¾è®¡è§„èŒƒçš„åŸç”Ÿæ ·å¼é€‰æ‹©å™¨ï¼š

#### 1. **æ ‡å‡†å¯¼èˆªæ **

- âœ… UINavigationBar æ ‡å‡†æ ·å¼
- âœ… æ ‡é¢˜å±…ä¸­æ˜¾ç¤º"åœ°å›¾æ ·å¼"
- âœ… å–æ¶ˆæŒ‰é’®åœ¨å·¦ä¸Šè§’

#### 2. **åœ°å›¾å®æ—¶é¢„è§ˆ**

- âœ… å æ®å±å¹•ä¸Šéƒ¨ 30%
- âœ… æ˜¾ç¤ºç”¨æˆ·å½“å‰ä½ç½®
- âœ… åˆ‡æ¢æ ·å¼å³æ—¶æ›´æ–°
- âœ… æ”¯æŒç¼©æ”¾å’Œæ‹–åŠ¨

#### 3. **iOS æ ‡å‡†å¡ç‰‡åˆ—è¡¨**

- âœ… åœ†è§’ 12pt å¡ç‰‡è®¾è®¡
- âœ… é€‰ä¸­æ—¶è“è‰²è¾¹æ¡† + checkmarkå›¾æ ‡
- âœ… æ¸…æ™°çš„æ ‡é¢˜å’Œæè¿°å±‚æ¬¡
- âœ… å®Œç¾æ”¯æŒæ·±è‰²æ¨¡å¼

#### 4. **å›ºå®šåº•éƒ¨æŒ‰é’®**

- âœ… è“è‰²"åº”ç”¨"æŒ‰é’®å§‹ç»ˆå¯è§
- âœ… æ— éœ€æ»šåŠ¨åˆ°åº•éƒ¨
- âœ… é«˜åº¦é€‚é… Safe Area
- âœ… å¸¦é¡¶éƒ¨åˆ†éš”çº¿

### ä½¿ç”¨æµç¨‹

```text
ç”¨æˆ·æ‰“å¼€App
    â†“
ç‚¹å‡»"åœ°å›¾æ ·å¼è®¾ç½®"
    â†“
æŸ¥çœ‹7ç§æ ·å¼ + åœ°å›¾é¢„è§ˆ
    â†“
é€‰æ‹©å–œæ¬¢çš„æ ·å¼
    â†“
é…ç½® Light Presetï¼ˆå¯é€‰ï¼‰
    â†“
ç‚¹å‡»"åº”ç”¨"æŒ‰é’®
    â†“
è®¾ç½®è‡ªåŠ¨ä¿å­˜åˆ° UserDefaults âœ…
    â†“
åç»­æ‰€æœ‰å¯¼èˆªè‡ªåŠ¨ä½¿ç”¨ ğŸ‰
```

## ğŸ’¾ æŒä¹…åŒ–å­˜å‚¨æœºåˆ¶

### UserDefaults é”®å€¼

æ ·å¼è®¾ç½®å­˜å‚¨åœ¨ iOS UserDefaults ä¸­ï¼š

| Key | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `mapbox_map_style` | String | åœ°å›¾æ ·å¼ï¼ˆstandard/faded/monochromeç­‰ï¼‰ |
| `mapbox_light_preset` | String? | Light Presetï¼ˆdawn/day/dusk/nightï¼‰ |
| `mapbox_enable_dynamic_light_preset` | Bool | åŠ¨æ€åˆ‡æ¢å¼€å…³ |

### å­˜å‚¨æ—¶æœº

- âœ… ç”¨æˆ·åœ¨æ ·å¼é€‰æ‹©å™¨ä¸­ç‚¹å‡»"åº”ç”¨"æŒ‰é’®
- âœ… ç«‹å³åŒæ­¥å†™å…¥ UserDefaults
- âœ… ä¸éœ€è¦åº”ç”¨é‡å¯

### åŠ è½½æ—¶æœº

- âœ… NavigationFactory åˆå§‹åŒ–æ—¶è‡ªåŠ¨åŠ è½½
- âœ… æ¯æ¬¡å¯åŠ¨å¯¼èˆªæ—¶è‡ªåŠ¨åº”ç”¨
- âœ… æ— éœ€æ‰‹åŠ¨ç®¡ç†

### ç”Ÿå‘½å‘¨æœŸ

```text
åº”ç”¨å¯åŠ¨
    â†“
NavigationFactory.init()
    â†“
è‡ªåŠ¨ä» UserDefaults åŠ è½½æ ·å¼è®¾ç½®
    â†“
_mapStyle, _lightPreset, _enableDynamicLightPreset å·²è®¾ç½® âœ…
    â†“
ç”¨æˆ·å¯åŠ¨å¯¼èˆª
    â†“
è‡ªåŠ¨åº”ç”¨åŠ è½½çš„æ ·å¼ ğŸŠ
```

## ğŸ—ï¸ æŠ€æœ¯å®ç°

### iOS æ¶æ„

#### 1. **StylePickerViewController**

åŸç”Ÿæ ·å¼é€‰æ‹©å™¨è§†å›¾æ§åˆ¶å™¨ï¼š

```swift
import UIKit
import MapboxMaps
import CoreLocation

class StylePickerViewController: UIViewController {
    // åœ°å›¾é¢„è§ˆ
    private var mapView: MapView?
    private let locationManager = CLLocationManager()
    
    // UI ç»„ä»¶
    private let mapContainerView = UIView()
    private let scrollView = UIScrollView()
    private let bottomButtonContainer = UIView()
    
    // æ ·å¼é…ç½®
    private var selectedStyle: String = "standard"
    private var selectedLightPreset: String = "day"
    private var enableDynamicLightPreset: Bool = false
}
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- æ˜¾ç¤ºåœ°å›¾é¢„è§ˆï¼ˆç”¨æˆ·å½“å‰ä½ç½®ï¼‰
- æä¾›æ ·å¼å’Œ Light Preset é€‰æ‹©
- å®æ—¶æ›´æ–°åœ°å›¾é¢„è§ˆ
- è¿”å›ç”¨æˆ·é€‰æ‹©çš„é…ç½®

#### 2. **StylePickerHandler**

å¤„ç† Flutter å’ŒåŸç”Ÿçš„é€šä¿¡ï¼š

```swift
class StylePickerHandler: NSObject {
    private let channel: FlutterMethodChannel
    
    func handleMethodCall(_ call: FlutterMethodCall, result: @escaping FlutterResult) {
        switch call.method {
        case "showStylePicker":
            // æ˜¾ç¤ºæ ·å¼é€‰æ‹©å™¨
        case "getStoredStyle":
            // è¯»å–å­˜å‚¨çš„æ ·å¼
        case "clearStoredStyle":
            // æ¸…é™¤å­˜å‚¨çš„æ ·å¼
        }
    }
    
    private func saveStyleSettings(_ pickerResult: StylePickerResult) {
        // ä¿å­˜åˆ° UserDefaults
    }
}
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- å“åº” Flutter æ–¹æ³•è°ƒç”¨
- æ˜¾ç¤ºæ ·å¼é€‰æ‹©å™¨
- ä¿å­˜è®¾ç½®åˆ° UserDefaults
- æä¾›æŸ¥è¯¢å’Œæ¸…é™¤åŠŸèƒ½

#### 3. **NavigationFactory**

å¯¼èˆªå·¥å‚ï¼Œè‡ªåŠ¨åŠ è½½å’Œåº”ç”¨æ ·å¼ï¼š

```swift
class NavigationFactory {
    private var _mapStyle: String?
    private var _lightPreset: String?
    private var _enableDynamicLightPreset: Bool = false
    
    init() {
        // è‡ªåŠ¨ä» UserDefaults åŠ è½½æ ·å¼è®¾ç½®
        loadStoredStyleSettings()
    }
    
    private func loadStoredStyleSettings() {
        let defaults = UserDefaults.standard
        _mapStyle = defaults.string(forKey: "mapbox_map_style")
        _lightPreset = defaults.string(forKey: "mapbox_light_preset")
        _enableDynamicLightPreset = defaults.bool(forKey: "mapbox_enable_dynamic_light_preset")
    }
}
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- åˆå§‹åŒ–æ—¶è‡ªåŠ¨åŠ è½½å­˜å‚¨çš„æ ·å¼
- å¯åŠ¨å¯¼èˆªæ—¶è‡ªåŠ¨åº”ç”¨æ ·å¼
- ä¸è¢« Flutter å‚æ•°è¦†ç›–ï¼ˆé™¤éæ˜ç¡®ä¼ å…¥ï¼‰

### Dart API

```dart
class MapboxStylePicker {
  static const MethodChannel _channel = 
    MethodChannel('flutter_mapbox_navigation/style_picker');

  /// æ˜¾ç¤ºæ ·å¼é€‰æ‹©å™¨
  static Future<bool> show() async {
    try {
      final result = await _channel.invokeMethod('showStylePicker');
      return result == true;
    } catch (e) {
      return false;
    }
  }

  /// è·å–å­˜å‚¨çš„æ ·å¼è®¾ç½®
  static Future<Map<String, dynamic>> getStoredStyle() async {
    final result = await _channel.invokeMethod('getStoredStyle');
    return Map<String, dynamic>.from(result ?? {});
  }

  /// æ¸…é™¤å­˜å‚¨çš„æ ·å¼è®¾ç½®
  static Future<bool> clearStoredStyle() async {
    try {
      await _channel.invokeMethod('clearStoredStyle');
      return true;
    } catch (e) {
      return false;
    }
  }
}
```

### æ ·å¼åº”ç”¨æµç¨‹

```text
1. ç”¨æˆ·æ‰“å¼€æ ·å¼é€‰æ‹©å™¨
   â†“
2. StylePickerViewController æ˜¾ç¤º
   - åœ°å›¾å®šä½åˆ°ç”¨æˆ·ä½ç½®
   - æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æ ·å¼
   - è‡ªåŠ¨é€‰æ‹©å½“å‰æ—¶é—´å¯¹åº”çš„ Light Preset
   â†“
3. ç”¨æˆ·é€‰æ‹©æ ·å¼å’Œé…ç½®
   - å®æ—¶æ›´æ–°åœ°å›¾é¢„è§ˆ
   - å¯ä»¥åˆ‡æ¢ä¸åŒ Light Preset æŸ¥çœ‹æ•ˆæœ
   â†“
4. ç”¨æˆ·ç‚¹å‡»"åº”ç”¨"
   â†“
5. StylePickerHandler.saveStyleSettings()
   - ä¿å­˜åˆ° UserDefaults
   - åŒæ­¥å­˜å‚¨
   â†“
6. è¿”å› true åˆ° Flutter
   â†“
7. ä¸‹æ¬¡å¯åŠ¨å¯¼èˆª
   â†“
8. NavigationFactory.init()
   - è‡ªåŠ¨åŠ è½½å­˜å‚¨çš„æ ·å¼
   â†“
9. åœ°å›¾è‡ªåŠ¨åº”ç”¨æ ·å¼ âœ…
```

## ğŸ¨ UI è®¾è®¡äº®ç‚¹

### ç¬¦åˆ iOS Human Interface Guidelines

#### 1. **Clarityï¼ˆæ¸…æ™°æ€§ï¼‰**

- âœ… æ ‡å‡†å¯¼èˆªæ æ¸…æ™°æ ‡é¢˜
- âœ… æ˜ç¡®çš„è§†è§‰å±‚æ¬¡
- âœ… æ¸…æ™°çš„é€‰ä¸­çŠ¶æ€ï¼ˆè“è‰²è¾¹æ¡† + checkmarkï¼‰

#### 2. **Deferenceï¼ˆé¡ºä»æ€§ï¼‰**

- âœ… ä½¿ç”¨ç³»ç»Ÿæ ‡å‡†ç»„ä»¶ï¼ˆUINavigationBarï¼‰
- âœ… éµå¾ªç³»ç»Ÿé¢œè‰²æ–¹æ¡ˆï¼ˆæ”¯æŒæ·±è‰²æ¨¡å¼ï¼‰
- âœ… ç³»ç»Ÿå›¾æ ‡ï¼ˆSF Symbols checkmark.circle.fillï¼‰

#### 3. **Depthï¼ˆæ·±åº¦æ„Ÿï¼‰**

- âœ… å¡ç‰‡å¼è®¾è®¡æœ‰å±‚æ¬¡
- âœ… å›ºå®šæŒ‰é’®ä¸æ»šåŠ¨å†…å®¹åˆ†ç¦»
- âœ… é€‚å½“çš„åœ†è§’å’Œé˜´å½±

### å¸ƒå±€ç»“æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å–æ¶ˆ]     åœ°å›¾æ ·å¼      â”‚ â† UINavigationBar
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚    åœ°å›¾é¢„è§ˆï¼ˆ30%ï¼‰       â”‚ â† å›ºå®šï¼Œæ˜¾ç¤ºç”¨æˆ·ä½ç½®
â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ScrollView            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ“ Standard       â”‚   â”‚ â† iOS æ ‡å‡†å¡ç‰‡
â”‚  â”‚   Standard Sat   â”‚   â”‚
â”‚  â”‚   Faded          â”‚   â”‚
â”‚  â”‚   ...            â”‚   â”‚
â”‚  â”‚                  â”‚   â”‚
â”‚  â”‚ Light Preset:    â”‚   â”‚
â”‚  â”‚ ğŸŒ… Dawn          â”‚   â”‚
â”‚  â”‚ âœ“ â˜€ï¸ Day         â”‚   â”‚
â”‚  â”‚   ğŸŒ‡ Dusk        â”‚   â”‚
â”‚  â”‚   ğŸŒ™ Night       â”‚   â”‚
â”‚  â”‚                  â”‚   â”‚
â”‚  â”‚ â–¡ åŠ¨æ€åˆ‡æ¢        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â† å›ºå®šåˆ†éš”çº¿
â”‚   [  åº”ç”¨æŒ‰é’®  ]         â”‚ â† å§‹ç»ˆå¯è§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ·±è‰²æ¨¡å¼æ”¯æŒ

æ‰€æœ‰é¢œè‰²ä½¿ç”¨ç³»ç»Ÿè¯­ä¹‰é¢œè‰²ï¼Œå®Œç¾é€‚é…æ·±è‰²æ¨¡å¼ï¼š

```swift
// èƒŒæ™¯è‰²
.systemBackground
.systemGroupedBackground  
.secondarySystemGroupedBackground

// æ–‡å­—é¢œè‰²
.label
.secondaryLabel

// åˆ†éš”çº¿
.separator

// å¼ºè°ƒè‰²
.systemBlue
```

## ğŸ“Š æ•°æ®æµå›¾

```text
Flutter Layer:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MapboxStylePicker.show()            â”‚
â”‚  â†“                                   â”‚
â”‚  MethodChannel.invokeMethod()        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
Platform Channel (iOS)
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  StylePickerHandler                  â”‚
â”‚  â†“                                   â”‚
â”‚  presentStylePicker()                â”‚
â”‚  â†“                                   â”‚
â”‚  StylePickerViewController.show()   â”‚
â”‚  â†“                                   â”‚
â”‚  User makes selection                â”‚
â”‚  â†“                                   â”‚
â”‚  saveStyleSettings()                 â”‚
â”‚  â†“                                   â”‚
â”‚  UserDefaults.set()                  â”‚
â”‚  â†“                                   â”‚
â”‚  return true                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next Navigation Start               â”‚
â”‚  â†“                                   â”‚
â”‚  NavigationFactory.init()            â”‚
â”‚  â†“                                   â”‚
â”‚  loadStoredStyleSettings()           â”‚
â”‚  â†“                                   â”‚
â”‚  UserDefaults.get()                  â”‚
â”‚  â†“                                   â”‚
â”‚  Apply to mapView âœ…                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” ç¤ºä¾‹ä»£ç 

### å®Œæ•´ç¤ºä¾‹

```dart
import 'package:flutter/material.dart';
import 'package:flutter_mapbox_navigation/flutter_mapbox_navigation.dart';

class StylePickerExample extends StatefulWidget {
  const StylePickerExample({Key? key}) : super(key: key);

  @override
  State<StylePickerExample> createState() => _StylePickerExampleState();
}

class _StylePickerExampleState extends State<StylePickerExample> {
  Map<String, dynamic> _currentSettings = {};

  @override
  void initState() {
    super.initState();
    _loadCurrentSettings();
  }

  Future<void> _loadCurrentSettings() async {
    final settings = await MapboxStylePicker.getStoredStyle();
    setState(() {
      _currentSettings = settings;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('åœ°å›¾æ ·å¼è®¾ç½®'),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            // æ˜¾ç¤ºå½“å‰è®¾ç½®
            if (_currentSettings.isNotEmpty) ...[
              Text('å½“å‰æ ·å¼: ${_currentSettings['mapStyle'] ?? 'æœªè®¾ç½®'}'),
              const SizedBox(height: 8),
              Text('Light Preset: ${_currentSettings['lightPreset'] ?? 'æœªè®¾ç½®'}'),
              const SizedBox(height: 32),
            ],
            
            // æ‰“å¼€æ ·å¼é€‰æ‹©å™¨
            ElevatedButton.icon(
              onPressed: () async {
                final success = await MapboxStylePicker.show();
                if (success) {
                  ScaffoldMessenger.of(context).showSnackBar(
                    const SnackBar(content: Text('æ ·å¼è®¾ç½®æˆåŠŸï¼')),
                  );
                  _loadCurrentSettings();
                }
              },
              icon: const Icon(Icons.palette),
              label: const Text('é€‰æ‹©åœ°å›¾æ ·å¼'),
            ),
            
            const SizedBox(height: 16),
            
            // æ¸…é™¤è®¾ç½®
            TextButton(
              onPressed: () async {
                await MapboxStylePicker.clearStoredStyle();
                ScaffoldMessenger.of(context).showSnackBar(
                  const SnackBar(content: Text('å·²æ¢å¤é»˜è®¤æ ·å¼')),
                );
                _loadCurrentSettings();
              },
              child: const Text('æ¢å¤é»˜è®¤'),
            ),
            
            const SizedBox(height: 32),
            
            // æµ‹è¯•å¯¼èˆª
            ElevatedButton(
              onPressed: () {
                // å¯åŠ¨å¯¼èˆªï¼Œè‡ªåŠ¨ä½¿ç”¨å­˜å‚¨çš„æ ·å¼
                // æ— éœ€ä¼ é€’ä»»ä½•æ ·å¼å‚æ•°
                Navigator.pushNamed(context, '/navigation');
              },
              child: const Text('å¼€å§‹å¯¼èˆªï¼ˆè‡ªåŠ¨ä½¿ç”¨è®¾ç½®çš„æ ·å¼ï¼‰'),
            ),
          ],
        ),
      ),
    );
  }
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. **æƒé™é…ç½®**

iOS éœ€è¦åœ¨ Info.plist ä¸­é…ç½®ä½ç½®æƒé™ï¼š

```xml
<key>NSLocationWhenInUseUsageDescription</key>
<string>Shows your location on the map and helps improve the map</string>
```

### 2. **æ ·å¼ URI å¤„ç†**

- Faded å’Œ Monochrome æ˜¯ Standard çš„ä¸»é¢˜å˜ä½“
- éœ€è¦é€šè¿‡ `setStyleImportConfigProperty` è®¾ç½® theme
- ä¸æ˜¯ç‹¬ç«‹çš„æ ·å¼ URI

### 3. **Light Preset æ”¯æŒ**

- ä»…æ”¯æŒ Standard ç³»åˆ—æ ·å¼ï¼ˆstandard/standardSatellite/faded/monochromeï¼‰
- ä¼ ç»Ÿæ ·å¼ï¼ˆlight/dark/outdoorsï¼‰ä¸æ”¯æŒ Light Preset
- é€‰æ‹©ä¸æ”¯æŒçš„æ ·å¼æ—¶ï¼ŒLight Preset ä¸ä¼šä¿å­˜

### 4. **å­˜å‚¨æœºåˆ¶**

- ä½¿ç”¨ iOS UserDefaults å­˜å‚¨
- åº”ç”¨å¸è½½åè®¾ç½®ä¼šä¸¢å¤±
- å¦‚éœ€äº‘åŒæ­¥éœ€è‡ªè¡Œå®ç°

### 5. **æ€§èƒ½è€ƒè™‘**

- åˆ‡æ¢æ ·å¼ä¼šè§¦å‘åœ°å›¾é‡æ–°æ¸²æŸ“
- ä¸å»ºè®®é¢‘ç¹åˆ‡æ¢æ ·å¼
- åŠ¨æ€ Light Preset åˆ‡æ¢ä¸»è¦ç”¨äºæ¼”ç¤º

## ğŸ‰ ä¸»è¦ä¼˜åŠ¿

| æ–¹é¢ | ä¼ ç»Ÿæ–¹å¼ | æ–°æ–¹å¼ï¼ˆæ ·å¼é€‰æ‹©å™¨ï¼‰ | æ”¹è¿› |
|------|---------|---------------------|------|
| **è®¾ç½®æ–¹å¼** | ç¼–å†™ä»£ç  | ç‚¹å‡»ç•Œé¢ | âœ… 100% æ›´ç®€å• |
| **å‚æ•°ä¼ é€’** | æ¯æ¬¡éƒ½ä¼  | æ— éœ€ä¼ é€’ | âœ… å‡å°‘ 100% |
| **å…¨å±€ç”Ÿæ•ˆ** | æ‰‹åŠ¨ç®¡ç† | è‡ªåŠ¨ç®¡ç† | âœ… é›¶ç»´æŠ¤æˆæœ¬ |
| **ç”¨æˆ·ä½“éªŒ** | å¼€å‘è€…è®¾ç½® | ç”¨æˆ·è‡ªä¸»é€‰æ‹© | âœ… æ›´åŠ ä¸ªæ€§åŒ– |
| **æŒä¹…åŒ–** | éœ€è‡ªå·±å®ç° | è‡ªåŠ¨æŒä¹…åŒ– | âœ… å¼€ç®±å³ç”¨ |
| **ç•Œé¢è®¾è®¡** | æ—  | iOS åŸç”Ÿ | âœ… å®Œç¾ç¬¦åˆè§„èŒƒ |

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Mapbox iOS Maps - Set a Style](https://docs.mapbox.com/ios/maps/guides/styles/set-a-style/)
- [Mapbox Standard Style](https://docs.mapbox.com/mapbox-gl-js/guides/styles/#mapbox-standard)
- [Light Presets Documentation](https://docs.mapbox.com/mapbox-gl-js/style-spec/light/)
- [iOS Human Interface Guidelines](https://developer.apple.com/design/human-interface-guidelines/)

## ğŸ”„ ç‰ˆæœ¬å†å²

### v3.1.1 (2024-11-16)

- âœ… æ·»åŠ åœ°å›¾é¢„è§ˆè‡ªåŠ¨å®šä½åˆ°ç”¨æˆ·å½“å‰ä½ç½®
- âœ… æ™ºèƒ½è¯·æ±‚ä½ç½®æƒé™
- âœ… ä¼˜é›…çš„é™çº§å¤„ç†ï¼ˆæ— ä½ç½®æ—¶ä½¿ç”¨åŒ—äº¬ï¼‰

### v3.1.0 (2024-11-16)

- âœ… å®Œå…¨é‡æ„ UIï¼Œç¬¦åˆ iOS è®¾è®¡è§„èŒƒ
- âœ… æ·»åŠ æ ‡å‡† UINavigationBar
- âœ… å›ºå®šåº•éƒ¨æŒ‰é’®ï¼Œå§‹ç»ˆå¯è§
- âœ… iOS æ ‡å‡†å¡ç‰‡æ ·å¼
- âœ… å®Œç¾æ”¯æŒæ·±è‰²æ¨¡å¼

### v3.0.0 (2024-11-15)

- âœ… é‡æ„ä¸ºè‡ªåŠ¨å­˜å‚¨æ¨¡å¼
- âœ… ç§»é™¤æ‰‹åŠ¨ä¼ å‚é€»è¾‘
- âœ… æ·»åŠ  UserDefaults æŒä¹…åŒ–
- âœ… ç®€åŒ– Dart API
- âœ… æ¸…ç†æ—§ä»£ç å’Œç¤ºä¾‹

### v2.0.0

- âœ… æ·»åŠ  Faded å’Œ Monochrome ä¸»é¢˜æ”¯æŒ
- âœ… å®ç° Light Preset åŠŸèƒ½
- âœ… æ·»åŠ åŠ¨æ€åˆ‡æ¢åŠŸèƒ½

### v1.0.0

- âœ… åˆå§‹å®ç°åœ°å›¾æ ·å¼é€‰æ‹©
- âœ… æ”¯æŒ 7 ç§é¢„å®šä¹‰æ ·å¼

## ğŸš€ åç»­è®¡åˆ’

- [ ] Android ç«¯å®ç°
- [ ] å¯è‡ªå®šä¹‰åŠ¨æ€åˆ‡æ¢é—´éš”
- [ ] æ”¯æŒæ›´å¤š Mapbox æ ·å¼
- [ ] æ ¹æ®ç³»ç»Ÿæš—é»‘æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢
- [ ] æ·»åŠ æ ·å¼é¢„è§ˆç¼©ç•¥å›¾
- [ ] æ”¯æŒè‡ªå®šä¹‰æ ·å¼ URL

## ğŸ“§ åé¦ˆä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- GitHub Issues: [flutter_mapbox_navigation](https://github.com/your-repo/flutter_mapbox_navigation)
- Email: support@example.com

---

**æœ€åæ›´æ–°**: 2024-11-16  
**ç‰ˆæœ¬**: v3.1.1  
**ç»´æŠ¤è€…**: Cascade AI
